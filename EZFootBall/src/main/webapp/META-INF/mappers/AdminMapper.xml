<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sample.dao.AdminDAO">
	<!-- 신청 관리 -->
	<select id="allgame" resultType="FieldReservationVO">
		select *
		from field_reservation
		where rv_type = 'S' or rv_type = 'TS';
	</select>
	
	<select id="alluser" resultType="UserVO">
		select *
		from user_info
	</select>
	
	<!-- 팀 매치 예약 현황 -->
	<select id="Tgame" resultType="FieldReservationVO">
		select *
		from field_reservation
		where rv_type = 'T';
	</select>
	
	<select id="joinList" resultType="FieldReservationVO">
		select a.rv_code, a.rv_day, a.field_name, a.field_type, a.game_day, date_format(a.game_time, '%H:%m') as game_time, a.game_code, a.user_code, b.user_name
		FROM field_reservation a
		inner JOIN user_info b ON a.user_code = b.user_code 
		ORDER BY a.game_day DESC
	</select>
	
	<select id="joinList1" resultType="FieldReservationVO" parameterType="FieldReservationVO">
		select a.rv_code rv_code, a.rv_day rv_day, a.field_name field_name, a.field_type field_type, a.game_day game_day, date_format(a.game_time, '%H:%m') as game_time, a.game_code game_code, a.user_code user_code, b.user_name user_name
		FROM field_reservation a
		inner JOIN user_info b ON a.user_code = b.user_code 
		<where>
			<if test="userName != null">
				and b.user_name like concat('%',#{userName},'%')
			</if>
			<if test="srvCode != null">
				and a.rv_code like concat('%',#{srvCode},'%')
			</if>
			<if test="rvDay != null">
				and a.rv_day like concat('%',#{rvDay},'%')
			</if>
			<if test="fieldName != null">
				and a.fieldName like concat('%',#{fieldName},'%')
			</if>
			<if test="gameDay != null">
				and a.game_day like concat('%',#{gameDay},'%')
			</if>
			<if test="fieldType != null">
				and a.field_type like concat('%',#{fieldType},'%')
			</if>
			<if test="suserCode != null">
				and a.user_code like concat('%',#{suserCode},'%')
			</if>
			<if test="sgameCode != null">
				and a.game_code like concat('%',#{sgameCode},'%')
			</if>
		</where>
		ORDER BY a.game_day DESC
	</select>
	
	<!-- 팀예약 삭제 mapper - gamelist, field_reservation 모두 삭제-->
	<delete id="TdeleteG">
		DELETE 
		FROM field_reservation
		WHERE game_code = #{gameCode}
	</delete>
	
	<delete id="TdeleteF">
		Delete
		FROM gamelist
		WHERE game_code = #{gameCode}
	</delete>
	
	
	
	
	
	
	
	
	
	
</mapper>